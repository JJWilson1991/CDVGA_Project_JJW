---
title: "Time_Series_Analysis"
author: "Jonathan Wilson"
date: "13/11/2019"
output: html_document
---

```{r}
library(fpp2)
library(tidyr)
```
```{r}
CDV_Clean <-   readRDS("../../data/processed_data/CDVprocesseddata.rds")

TSCDV<- with(CDV_Clean,table(CollectionYear))
tTSCDV<-ts(TSCDV)
#plot.ts(tTSCDV)
```
```{r}
#RACnum <- readRDS("../../data/processed_data/RaCFoxMappingData.rds")
RGFAges <- subset(RGFAge, State %in% c("Georgia"))

RGFTS<-  as.data.frame(with(RGFAges, table(Species, CollectionYear)))
RGFTSS <- RGFTS %>% spread(key = Species, value = Freq)
#testp <- RGFTS %>% spread(key = Species, value = Freq)
```
```{r}
tsrt<- ts(RGFTSS)
```

```{r}
autoplot(tsrt[,c("Raccoon", "Gray Fox")]) +
  ylab("Cases") + xlab("Year")


```
```{r}

dfRF <- as.data.frame(tsrt)
dfRF<- dplyr :: rename(dfRF, GrayFox = "Gray Fox")
 ggplot(dfRF, aes(x=Raccoon, y=GrayFox)) +
    ylab("Gray Fox Cases") +
    xlab("Raccoon Cases") +
    geom_point() +
    geom_smooth(method="lm", se=FALSE) + coord_fixed(1)
```
```{r}
fit.consMR <- tslm("Raccoon" ~ "Gray Fox", data=tsrt)
summary(fit.consMR)
```
```{r}
autoplot(tsrt[,'Raccoon'], series="Data") +
  autolayer(fitted(fit.consMR), series="Fitted") +
  xlab("Year") + ylab("") +
  ggtitle("Percent change in US consumption expenditure") +
  guides(colour=guide_legend(title=" "))


```